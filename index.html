<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé® P-Blocks</title>
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- √âl√©ments Mobile -->
    <!-- Menu BLEU √† gauche pour les blocs -->
    <button class="mobile-menu-btn" id="mobile-menu-btn" onclick="toggleMobileMenu()">‚ò∞</button>
    
    <!-- Menu ORANGE √† droite pour les modes -->
    <button class="mobile-mode-menu-btn" id="mobile-mode-menu-btn" onclick="toggleMobileMode()">‚ò∞</button>
    
    <div class="mobile-overlay" id="mobile-overlay" onclick="closeMobileMenus()"></div>
    
    <!-- Panneau des blocs (gauche) -->
    <div class="mobile-blocks-panel" id="mobile-blocks-panel">
        <div id="mobile-blocks-list"></div>
    </div>
    
    <!-- Panneau des modes (droite) -->
    <div class="mobile-mode-panel" id="mobile-mode-panel">
        <button class="mode-btn" id="mobile-student-mode-btn" onclick="switchModeAndClose('student')" style="display: none; background: #2196F3; color: white;">üìñ Aper√ßu mode √©l√®ve</button>
        <button class="mode-btn" id="mobile-teacher-mode-btn" onclick="switchModeAndClose('teacher')" style="color: #2196F3;">‚úèÔ∏è Cr√©ation de niveaux</button>
        
        <!-- Boutons √âL√àVE (sauvegarde/chargement avec code) -->
        <div id="mobile-student-buttons" style="display: none; margin-top: 15px;">
            <button class="mode-btn" id="mobile-student-save-btn" onclick="generateStudentCodeMobile()" style="background: #FF9800; color: white; width: 100%; margin-bottom: 8px;">üíæ Sauvegarder</button>
            <button class="mode-btn" id="mobile-student-load-btn" onclick="openLoadProgressModalMobile()" style="background: #9C27B0; color: white; width: 100%; margin-bottom: 8px;">üì• Charger</button>
            <button class="mode-btn" id="mobile-thanks-btn" onclick="openThanksModal()" style="background: #FF8A80; color: white; width: 100%; margin-bottom: 8px;">‚ù§Ô∏è Merci</button>
        </div>
        
        <!-- Boutons professeur (visibles uniquement en mode professeur) -->
        <div id="mobile-teacher-buttons" style="display: none; margin-top: 15px;">
            <!-- Boutons en ligne (synchronis√©s avec PC) -->
            <button class="mode-btn" id="mobile-save-online-btn" onclick="saveLevelBeforeOnlineMobile()" style="display: none; background: #4CAF50; color: white; width: 100%; margin-bottom: 8px;">‚òÅÔ∏è Sauvegarder en ligne</button>
            <button class="mode-btn" id="mobile-load-levels-btn" onclick="openLoadOnlineModalMobile()" style="display: none; background: #2196F3; color: white; width: 100%; margin-bottom: 8px;">üì• Charger les niveaux</button>
            
            <!-- Boutons conditionnels (synchronis√©s avec PC) -->
            <button class="mode-btn" id="mobile-copy-student-link-btn" onclick="copyStudentLinkMobile()" style="display: none; background: #FF9800; color: white; width: 100%; margin-bottom: 8px;">üîó Copier lien √©l√®ve</button>
            <button class="mode-btn" id="mobile-delete-online-btn" onclick="openDeleteOnlineModalMobile()" style="display: none; background: #f44336; color: white; width: 100%;">üóëÔ∏è Supprimer ma sauvegarde</button>
        </div>
    </div>
    
    <div class="app-container">
        <div class="header" id="app-header">
            <div>
                <h1 id="header-main-title">üé® P-Blocks - Aper√ßu mode √©l√®ve</h1>
                <div class="header-subtitle" id="header-subtitle" style="display: none;">Mode cr√©ation de niveaux</div>
            </div>
            <div class="score-display" id="header-score-display" style="background: rgba(255, 215, 0, 0.9); margin: 0 auto; padding: 8px 16px; font-size: 14px; display: flex; align-items: center; gap: 12px;">
                <span>üéØ Score: <span id="score" data-v="0"></span> points</span>
                <button id="reset-progress-btn" onclick="resetProgress()" style="background: #dc3545; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; font-weight: bold;" title="R√©initialiser le score et la progression">üîÑ R√©initialiser</button>
            </div>
            <!-- Conteneur pour coller mode-selector et help-button -->
            <div style="display: flex; align-items: center; gap: 10px;">
                <div class="mode-selector">
                    <div id="student-save-buttons" style="display: none;">
                        <button class="mode-btn" onclick="openThanksModal()" style="background: #FF8A80; border-color: white; padding: 8px 12px; font-size: 13px;">‚ù§Ô∏è Merci</button>
                        <button class="mode-btn" onclick="generateStudentCode()" style="background: #FF9800; border-color: white; padding: 8px 12px; font-size: 13px;">üíæ Sauvegarder</button>
                        <button class="mode-btn" onclick="openLoadProgressModal()" style="background: #9C27B0; border-color: white; padding: 8px 12px; font-size: 13px;">üì• Charger</button>
                    </div>
                    <button class="mode-btn" id="copy-student-link-btn" onclick="copyStudentLink()" style="display: none; background: #FF9800; border-color: white; color: white;">üîó Copier lien √©l√®ve</button>
                    <button class="mode-btn" id="delete-online-btn" onclick="openDeleteOnlineModal()" style="display: none; background: #f44336; border-color: white; color: white;">üóëÔ∏è Supprimer ma sauvegarde</button>
                    <button class="mode-btn" id="save-online-btn" onclick="saveLevelBeforeOnline()" style="display: none; background: #4CAF50; border-color: white; color: white;">‚òÅÔ∏è Sauvegarder en ligne</button>
                    <button class="mode-btn" id="load-levels-btn" onclick="openLoadOnlineModal()" style="display: none; background: #2196F3; border-color: white; color: white;">üì• Charger les niveaux</button>
                    <button class="mode-btn" id="student-mode-btn" onclick="switchMode('student')" style="display: none;">üìñ Aper√ßu mode √©l√®ve</button>
                    <button class="mode-btn" id="teacher-mode-btn" onclick="switchMode('teacher')">‚úèÔ∏è Cr√©ation de niveaux</button>
                </div>
                <!-- Bouton d'aide HORS du mode-selector pour √™tre visible en mobile -->
                <button id="help-button" onclick="showHelpTeacherModal()" style="display: none; background: #4CAF50; color: white; border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-size: 20px; font-weight: bold; margin: 0; flex-shrink: 0;" title="Aide">?</button>
            </div>
        </div>

        <div class="main-content">
            <!-- Colonne de GAUCHE - Grille et contr√¥les -->
            <div class="left-panel">
                <!-- Mode √âl√®ve -->
                <div id="student-left">
                    <div class="cursus-selector">
                        <label>Cursus:</label>
                        <select id="cursus-select" onchange="loadCursusLevels()">
                            <option value="5eme">5√®me</option>
                            <option value="4eme">4√®me</option>
                            <option value="3eme">3√®me</option>
                        </select>
                    </div>

                    <div class="level-selector">
                        <label>Niveau:</label>
                        <select id="level-select" onchange="loadLevel()">
                            <option value="0">Niveau 1</option>
                        </select>
                    </div>

                    <div style="margin-bottom: 5px; margin-top: 10px;">
                        <h4 style="text-align: center; font-size: 13px; color: #555; margin-bottom: 2px;">üìã Reproduis le motif ci-dessous</h4>
                        <div class="grid-container">
                            <div id="target-grid" class="grid"></div>
                        </div>
                    </div>

                    <div style="margin-bottom: 5px;">
                        <h4 style="text-align: center; font-size: 13px; color: #555; margin-bottom: 2px;">Ta grille</h4>
                        <div class="grid-container">
                            <div id="student-grid" class="grid"></div>
                        </div>
                    </div>
                    
                    <!-- Curseur de vitesse √©l√®ve (apr√®s les deux grilles) -->
                    <div class="speed-control">
                        <input type="range" id="student-execution-speed" min="0" max="100" value="90" step="10">
                        <span id="student-speed-label">Tr√®s rapide</span>
                    </div>

                    <div class="controls">
                        <button id="run-btn" class="btn btn-primary" onclick="executeProgram()">‚ñ∂Ô∏è<br>Tester</button>
                        <button class="btn btn-danger" onclick="clearGrid()">üóëÔ∏è<br>Effacer</button>
                        <button class="btn btn-success" onclick="validateLevel()">‚úÖ<br>Valider</button>
                    </div>
                    
                    <!-- Bouton d'aide (g√©r√© par helpSystem.js) - EN DEHORS de .controls -->
                    <button id="help-me-btn" class="btn btn-warning" onclick="showHelpSolution()" style="display: none; margin-top: 10px; width: 100%;">
                        ‚ùì Aidez-moi !
                    </button>

                    <div id="result-message"></div>
                </div>

                <!-- Mode Professeur -->
                <div id="teacher-left" style="display: none;">
                    <div class="cursus-selector">
                        <label>Cursus:</label>
                        <select id="teacher-cursus-select" onchange="loadTeacherLevels()">
                            <option value="5eme">5√®me</option>
                            <option value="4eme">4√®me</option>
                            <option value="3eme">3√®me</option>
                        </select>
                    </div>

                    <div class="level-selector">
                        <label>Niveau √† √©diter:</label>
                        <div style="display: flex; gap: 5px;">
                            <select id="teacher-level-select" onchange="saveCurrentAndLoadTeacherLevel()" style="flex: 1;">
                                <option value="new">+ Nouveau niveau</option>
                            </select>
                            <button class="btn" onclick="openLevelManagerModal()" style="padding: 8px 12px; background: #FF9800; color: white; font-size: 11px; white-space: nowrap;" title="G√©rer les niveaux et les mondes">
                                ‚öôÔ∏è G√©rer
                            </button>
                        </div>
                    </div>

                    <div class="paint-module">
                        <h4 style="font-size: 13px; color: #555; margin-bottom: 8px; font-weight: bold;">üé® Mode pinceau</h4>
                        <div class="color-picker" id="color-picker-section">
                            <div class="color-option" data-color="red" style="background-color: #FF0000;" onclick="selectPaintColor('red')" title="Rouge"></div>
                            <div class="color-option" data-color="yellow" style="background-color: #FFFF00;" onclick="selectPaintColor('yellow')" title="Jaune"></div>
                            <div class="color-option" data-color="green" style="background-color: #00FF00;" onclick="selectPaintColor('green')" title="Vert"></div>
                            <div class="color-option" data-color="blue" style="background-color: #0000FF;" onclick="selectPaintColor('blue')" title="Bleu"></div>
                            <div class="color-option" data-color="pink" style="background-color: #FF69B4;" onclick="selectPaintColor('pink')" title="Rose"></div>
                            <div class="color-option" data-color="black" style="background-color: #000000;" onclick="selectPaintColor('black')" title="Noir"></div>
                            <div class="color-option eraser" data-color="white" style="background-color: #FFFFFF; border: 2px solid #999;" onclick="selectPaintColor('white')" title="Gomme">üßπ</div>
                        </div>
                        <div class="pattern-picker" id="pattern-picker-section" style="display: none;">
                            <div class="pattern-option" data-pattern="stairs" onclick="selectPattern('stairs')" title="Escalier">
                                <svg width="40" height="40" viewBox="0 0 40 40">
                                    <path d="M 0,40 L 0,30 L 10,30 L 10,20 L 20,20 L 20,10 L 30,10 L 30,0 L 40,0 L 40,40 Z" fill="#333"/>
                                </svg>
                            </div>
                            <div class="pattern-option" data-pattern="checkerboard" onclick="selectPattern('checkerboard')" title="Damier">
                                <svg width="40" height="40" viewBox="0 0 40 40">
                                    <rect x="0" y="0" width="10" height="10" fill="#333"/>
                                    <rect x="20" y="0" width="10" height="10" fill="#333"/>
                                    <rect x="10" y="10" width="10" height="10" fill="#333"/>
                                    <rect x="30" y="10" width="10" height="10" fill="#333"/>
                                    <rect x="0" y="20" width="10" height="10" fill="#333"/>
                                    <rect x="20" y="20" width="10" height="10" fill="#333"/>
                                    <rect x="10" y="30" width="10" height="10" fill="#333"/>
                                    <rect x="30" y="30" width="10" height="10" fill="#333"/>
                                </svg>
                            </div>
                            <div class="pattern-option" data-pattern="square" onclick="selectPattern('square')" title="Carr√©">
                                <svg width="40" height="40" viewBox="0 0 40 40">
                                    <rect x="8" y="8" width="24" height="24" fill="none" stroke="#333" stroke-width="3"/>
                                </svg>
                            </div>
                            <div class="pattern-option" data-pattern="zigzag" onclick="selectPattern('zigzag')" title="Zigzag">
                                <svg width="40" height="40" viewBox="0 0 40 40">
                                    <path d="M 0,30 L 10,10 L 20,30 L 30,10 L 40,30" stroke="#333" stroke-width="3" fill="none"/>
                                </svg>
                            </div>
                            <div class="pattern-option" data-pattern="cross" onclick="selectPattern('cross')" title="Croix">
                                <svg width="40" height="40" viewBox="0 0 40 40">
                                    <path d="M 8,8 L 32,32 M 32,8 L 8,32" stroke="#333" stroke-width="3"/>
                                </svg>
                            </div>
                        </div>
                        <div style="display: flex; gap: 8px; margin-top: 10px; align-items: center;">
                            <select id="generation-difficulty" onchange="handleDifficultyChange()" style="flex: 1; padding: 8px; border: 2px solid #E0E0E0; border-radius: 4px; font-size: 12px; background: white;">
                                <option value="1">Difficult√© 1</option>
                                <option value="2">Difficult√© 2</option>
                                <option value="3">Difficult√© 3</option>
                            </select>
                            <button class="btn" onclick="generateProgramFromPaint()" style="flex: 2; background: #4CAF50; color: white; padding: 8px; font-size: 12px; font-weight: bold;">
                                ‚ö° G√©n√©rer
                            </button>
                        </div>
                        <button class="btn" onclick="generateRandomPattern()" style="width: 100%; margin-top: 8px; background: #FF9800; color: white; padding: 10px; font-size: 13px; font-weight: bold;">
                            üé≤ G√©n√©ration automatique
                        </button>
                    </div>

                    <!-- Container flex pour grille + boutons c√¥te √† c√¥te -->
                    <div class="teacher-grid-and-buttons-wrapper">
                        <div class="grid-container">
                            <div id="teacher-grid" class="grid"></div>
                            
                            <!-- Curseur de vitesse -->
                            <div class="speed-control">
                                <input type="range" id="execution-speed" min="0" max="100" value="90" step="10">
                                <span id="speed-label">Tr√®s rapide</span>
                            </div>
                        </div>

                        <div class="teacher-action-buttons">
                            <button class="btn btn-primary" onclick="executeProgram()">‚ñ∂Ô∏è Tester</button>
                            <button class="btn btn-danger" onclick="clearGridAndPaint()">üóëÔ∏è Effacer</button>
                            <button class="btn btn-success" onclick="addOrSaveLevel()">‚ûï Ajouter</button>
                            <button class="btn btn-warning" onclick="overwriteSelectedLevel()" id="overwrite-level-btn">üíæ √âcraser</button>
                        </div>
                    </div>

                    <div id="teacher-result-message"></div>
                </div>
            </div>

            <!-- Colonne du MILIEU - Palette de blocs -->
            <div class="middle-panel">
                <div class="blocks-palette">
                    <div class="blocks-category">
                        <div class="category-header expanded" onclick="toggleCategory(this)">
                            üé® Apparence
                        </div>
                        <div class="category-blocks">
                            <div class="block looks" draggable="true" ondragstart="drag(event)" data-type="color" data-value="red">couleur ROUGE</div>
                            <div class="block looks" draggable="true" ondragstart="drag(event)" data-type="color" data-value="yellow">couleur JAUNE</div>
                            <div class="block looks" draggable="true" ondragstart="drag(event)" data-type="color" data-value="green">couleur VERT</div>
                            <div class="block looks" draggable="true" ondragstart="drag(event)" data-type="color" data-value="blue">couleur BLEU</div>
                            <div class="block looks" draggable="true" ondragstart="drag(event)" data-type="color" data-value="pink">couleur ROSE</div>
                            <div class="block looks" draggable="true" ondragstart="drag(event)" data-type="color" data-value="black">couleur NOIR</div>
                        </div>
                    </div>

                    <div class="blocks-category">
                        <div class="category-header expanded" onclick="toggleCategory(this)">
                            ‚û°Ô∏è Mouvement
                        </div>
                        <div class="category-blocks">
                            <div class="block motion" draggable="true" ondragstart="drag(event)" data-type="forward">avancer</div>
                            <div class="block motion" draggable="true" ondragstart="drag(event)" data-type="back">reculer</div>
                            <div class="block motion" draggable="true" ondragstart="drag(event)" data-type="right">tourner ‚Üª droite</div>
                            <div class="block motion" draggable="true" ondragstart="drag(event)" data-type="left">tourner ‚Ü∫ gauche</div>
                        </div>
                    </div>

                    <div class="blocks-category">
                        <div class="category-header expanded" onclick="toggleCategory(this)">
                            üîÅ Contr√¥le
                        </div>
                        <div class="category-blocks">
                            <div class="block control" draggable="true" ondragstart="drag(event)" data-type="repeat">
                                r√©p√©ter 
                                <span class="value-slot" ondrop="dropValueOrOperator(event)" ondragover="allowDrop(event)">
                                    <input type="number" value="10" min="1" max="100" onclick="event.stopPropagation()">
                                </span>
                                fois
                            </div>
                        </div>
                    </div>

                    <div class="blocks-category">
                        <div class="category-header expanded" onclick="toggleCategory(this)">
                            üìä Variables
                        </div>
                        <div class="category-blocks">
                            <button class="btn" onclick="createNewVariable()" style="width: 100%; margin-bottom: 5px; padding: 6px; font-size: 12px; background: #FF8C1A; color: white;">
                                + Cr√©er une variable
                            </button>
                            <div id="variable-blocks" style="display: none;">
                                <div class="block variables" draggable="true" ondragstart="drag(event)" data-type="var-value">
                                    <select onclick="event.stopPropagation()" class="var-select">
                                        <option value="">variable</option>
                                    </select>
                                </div>
                                <div class="block variables" draggable="true" ondragstart="drag(event)" data-type="variable">
                                    mettre <select onclick="event.stopPropagation()" class="var-select"><option value="">nom</option></select> √† 
                                    <span class="value-slot" ondrop="dropValueOrOperator(event)" ondragover="allowDrop(event)">
                                        <input type="number" value="0" onclick="event.stopPropagation()">
                                    </span>
                                </div>
                                <div class="block variables" draggable="true" ondragstart="drag(event)" data-type="change-var">
                                    ajouter 
                                    <span class="value-slot" ondrop="dropValueOrOperator(event)" ondragover="allowDrop(event)">
                                        <input type="number" value="1" onclick="event.stopPropagation()">
                                    </span>
                                    √† <select onclick="event.stopPropagation()" class="var-select"><option value="">nom</option></select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="blocks-category">
                        <div class="category-header expanded" onclick="toggleCategory(this)">
                            üî¢ Op√©rateurs
                        </div>
                        <div class="category-blocks">
                            <div class="block operators" draggable="true" ondragstart="drag(event)" data-type="operator">
                                <span class="value-slot" ondrop="dropValueOrOperator(event)" ondragover="allowDrop(event)">
                                    <input type="text" placeholder="a" onclick="event.stopPropagation()">
                                </span>
                                <select onclick="event.stopPropagation()">
                                    <option value="+">+</option>
                                    <option value="-">-</option>
                                    <option value="*">√ó</option>
                                    <option value="/">√∑</option>
                                </select>
                                <span class="value-slot" ondrop="dropValueOrOperator(event)" ondragover="allowDrop(event)">
                                    <input type="text" placeholder="b" onclick="event.stopPropagation()">
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="blocks-category">
                        <div class="category-header expanded" onclick="toggleCategory(this)">
                            üîÄ Condition
                        </div>
                        <div class="category-blocks">
                            <div class="block sensing" draggable="true" ondragstart="drag(event)" data-type="if">
                                si 
                                <select class="var-select" onclick="event.stopPropagation()">
                                    <option value="">variable</option>
                                </select>
                                <select class="compare-op" onclick="event.stopPropagation()">
                                    <option value="<">&lt;</option>
                                    <option value=">">&gt;</option>
                                    <option value="=">=</option>
                                    <option value="<=">&le;</option>
                                    <option value=">=">&ge;</option>
                                </select>
                                <span class="value-slot" ondrop="dropValueOrOperator(event)" ondragover="allowDrop(event)">
                                    <input type="text" placeholder="valeur" onclick="event.stopPropagation()">
                                </span>
                                alors
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Colonne de DROITE - Zone de programmation -->
            <div class="right-panel">
                <div class="program-area" ondrop="drop(event)" ondragover="allowDrop(event)" ondragleave="dragLeave(event)">
                    <h3>üìù Mon Programme <span id="block-count" style="color: #888; font-size: 14px; font-weight: normal;">(0 blocs)</span></h3>
                    <div id="program-blocks" class="program-blocks-container" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
                </div>

                <div id="variable-display" class="variable-display" style="display: none;">
                    <h4>üìä Variables</h4>
                    <div id="variables-list" class="variables-list"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal pour le mot de passe professeur -->
    <div id="password-modal" class="modal">
        <div style="position: relative; max-width: 400px; width: 90%;">
            <span class="modal-close" onclick="closePasswordModal()">&times;</span>
            <div class="modal-content" style="margin: 0; width: 100%;">
                <h2>üîí Acc√®s Professeur</h2>
                <p>Entrez le mot de passe pour acc√©der au mode √©diteur:</p>
                <input type="password" id="teacher-password" placeholder="Mot de passe" oninput="checkPasswordAuto()" onkeypress="if(event.key === 'Enter') checkPassword()">
            </div>
        </div>
    </div>

    <!-- Modal pour cr√©er une variable -->
    <div id="variable-modal" class="modal">
        <div class="modal-content">
            <h2>üìä Cr√©er une variable</h2>
            <p>Entrez le nom de la nouvelle variable:</p>
            <input type="text" id="variable-name" placeholder="Nom de la variable" onkeypress="if(event.key === 'Enter') confirmCreateVariable()">
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="confirmCreateVariable()">Cr√©er</button>
                <button class="btn btn-danger" onclick="closeVariableModal()">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal pour g√©rer les niveaux et les mondes -->
    <div id="level-manager-modal" class="modal">
        <div class="modal-wrapper-large" style="position: relative; max-width: 800px; width: 95%; overflow: visible;">
            <span class="modal-close level-manager-close" onclick="closeLevelManagerModal()">&times;</span>
            <div class="modal-content" style="max-width: 800px; max-height: 85vh; padding: 40px 30px 30px 30px; margin: 0; width: 100%; overflow: visible;">
                <div style="max-height: calc(85vh - 80px); overflow-y: auto; overflow-x: visible; padding-right: 5px;">
                    <div class="modal-header-with-button">
                        <h2>‚öôÔ∏è Gestion des Niveaux et Mondes</h2>
                        <button class="btn auto-create-btn" onclick="openAutoCreateModal()">
                            ‚ú® Cr√©ation automatis√©e des niveaux
                        </button>
                    </div>
            
            <!-- Section Mondes -->
            <div style="background: #E3F2FD; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="color: #1976D2; margin-bottom: 10px; font-size: 16px;">üåç Configuration des Mondes</h3>
                <div class="worlds-config-inputs" style="display: flex; gap: 20px; margin-bottom: 15px;">
                    <div style="flex: 1; display: flex; flex-direction: column;">
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 13px;">Cursus:</label>
                        <select id="modal-cursus-select" onchange="switchModalCursus()" style="width: 80px; height: 34px; margin-top: 2px; padding: 6px; border: 2px solid #E0E0E0; border-radius: 4px; font-size: 13px; background: white; box-sizing: border-box; -webkit-appearance: none; -moz-appearance: none; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2712%27 height=%278%27 viewBox=%270 0 12 8%27%3e%3cpath fill=%27%23333%27 d=%27M0 0l6 8 6-8z%27/%3e%3c/svg%3e'); background-repeat: no-repeat; background-position: right 6px center; padding-right: 24px;">
                            <option value="5eme">5√®me</option>
                            <option value="4eme">4√®me</option>
                            <option value="3eme">3√®me</option>
                        </select>
                    </div>
                    <div style="flex: 1; display: flex; flex-direction: column;">
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 13px;">Nombre de mondes:</label>
                        <input type="number" id="num-worlds" min="1" max="10" value="1" onchange="updateWorldsConfig()" style="width: 80px; height: 34px; margin-top: 2px; padding: 6px; border: 2px solid #E0E0E0; border-radius: 4px; font-size: 13px; box-sizing: border-box;">
                    </div>
                    <div style="flex: 1; display: flex; flex-direction: column;">
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 13px;">Niveaux par monde:</label>
                        <input type="number" id="levels-per-world" min="1" max="20" value="10" onchange="updateWorldsConfig()" style="width: 80px; height: 34px; margin-top: 2px; padding: 6px; border: 2px solid #E0E0E0; border-radius: 4px; font-size: 13px; box-sizing: border-box;">
                    </div>
                </div>
                <div id="worlds-config" style="margin-top: 15px;">
                    <!-- Configuration des points par monde sera g√©n√©r√©e ici -->
                </div>
            </div>
            
            <!-- Section Liste des Niveaux -->
            <div style="background: #FFF9C4; padding: 15px; border-radius: 8px;">
                <h3 style="color: #F57F17; margin-bottom: 10px; font-size: 16px;">üìã Liste des Niveaux</h3>
                <p style="font-size: 12px; color: #666; margin-bottom: 10px;">Glissez-d√©posez un niveau sur un autre pour √©changer leur contenu</p>
                <div id="levels-list">
                    <!-- Liste des niveaux sera g√©n√©r√©e ici -->
                </div>
            </div>
            </div>
        </div>
        </div>
    </div>

    <!-- Modal pour la cr√©ation automatis√©e -->
    <div id="auto-create-modal" class="modal">
        <div class="modal-wrapper-large" style="position: relative; max-width: 600px; width: 95%; overflow: visible;">
            <span class="modal-close auto-create-close" onclick="closeAutoCreateModal()">&times;</span>
            <div class="modal-content" style="max-width: 600px; max-height: 85vh; padding: 40px 30px 30px 30px; margin: 0; width: 100%; overflow: visible;">
                <div style="max-height: calc(85vh - 80px); overflow-y: auto; overflow-x: visible; padding-right: 5px;">
                    <h2>‚ú® Cr√©ation Automatis√©e des Niveaux</h2>
                    
                    <!-- Bouton de g√©n√©ration -->
                    <button id="generate-btn-top" class="btn btn-success" onclick="generateWorldsAutomatically()" style="width: 100%; padding: 15px; font-size: 16px; font-weight: bold; margin-bottom: 20px;">
                        üé≤ G√©n√©rer automatiquement les mondes
                    </button>
                
                <!-- Configuration g√©n√©rale -->
                <div style="background: #E3F2FD; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <h3 style="color: #1976D2; margin-bottom: 10px; font-size: 16px;">Configuration g√©n√©rale</h3>
                <div class="auto-config-inputs" style="display: flex; gap: 20px; margin-bottom: 10px;">
                    <div style="flex: 1; display: flex; flex-direction: column;">
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 13px;">Cursus:</label>
                        <select id="auto-cursus-select" onchange="updateAutoLimits()" style="width: 80px; height: 34px; margin-top: 2px; padding: 6px; border: 2px solid #E0E0E0; border-radius: 4px; font-size: 13px; background: white; box-sizing: border-box; -webkit-appearance: none; -moz-appearance: none; appearance: none; background-image: url('data:image/svg+xml;charset=UTF-8,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2712%27 height=%278%27 viewBox=%270 0 12 8%27%3e%3cpath fill=%27%23333%27 d=%27M0 0l6 8 6-8z%27/%3e%3c/svg%3e'); background-repeat: no-repeat; background-position: right 6px center; padding-right: 24px;">
                            <option value="all">Tous</option>
                            <option value="5eme">5√®me</option>
                            <option value="4eme">4√®me</option>
                            <option value="3eme">3√®me</option>
                        </select>
                    </div>
                    <div style="flex: 1; display: flex; flex-direction: column;">
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 13px;">Nombre de mondes:</label>
                        <input type="number" id="auto-num-worlds" min="1" value="3" onchange="updateAutoWorldsConfig()" style="width: 80px; height: 34px; margin-top: 2px; padding: 6px; border: 2px solid #E0E0E0; border-radius: 4px; font-size: 13px; box-sizing: border-box;">
                    </div>
                    <div style="flex: 1; display: flex; flex-direction: column;">
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 13px;">Niveaux par monde:</label>
                        <input type="number" id="auto-levels-per-world" min="1" value="5" onchange="updateAutoWorldsConfig()" style="width: 80px; height: 34px; margin-top: 2px; padding: 6px; border: 2px solid #E0E0E0; border-radius: 4px; font-size: 13px; box-sizing: border-box;">
                    </div>
                </div>
            </div>
            
            <!-- Configuration rapide pour tous les mondes -->
            <div style="background: #E8F5E9; padding: 15px; border-radius: 8px; margin-bottom: 20px; border: 2px solid #4CAF50;">
                <h3 style="color: #2E7D32; margin-bottom: 10px; font-size: 16px;">‚ö° Configuration rapide (tous les mondes)</h3>
                <p style="font-size: 12px; color: #666; margin-bottom: 15px;">Configurez tous les mondes en une seule fois</p>
                
                <div class="quick-config-grid" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-bottom: 10px;">
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 13px;">Niveaux de difficult√© 1:</label>
                        <input type="number" id="quick-diff1" min="0" value="2" oninput="validateQuickConfig()" style="width: 100%; padding: 6px; border: 2px solid #E0E0E0; border-radius: 4px; font-size: 13px;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 13px;">Niveaux de difficult√© 2:</label>
                        <input type="number" id="quick-diff2" min="0" value="2" oninput="validateQuickConfig()" style="width: 100%; padding: 6px; border: 2px solid #E0E0E0; border-radius: 4px; font-size: 13px;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 13px;">Niveaux de difficult√© 3:</label>
                        <input type="number" id="quick-diff3" min="0" value="1" oninput="validateQuickConfig()" style="width: 100%; padding: 6px; border: 2px solid #E0E0E0; border-radius: 4px; font-size: 13px;">
                    </div>
                    <div>
                        <label style="display: block; font-weight: bold; margin-bottom: 5px; font-size: 13px;">Points requis (incr√©mental):</label>
                        <input type="number" id="quick-points" min="0" value="10" style="width: 100%; padding: 6px; border: 2px solid #E0E0E0; border-radius: 4px; font-size: 13px;">
                    </div>
                </div>
                
                <div id="quick-config-error" style="font-size: 12px; color: #f44336; margin-bottom: 10px; display: none;"></div>
                
                <button id="quick-apply-btn" class="btn" onclick="applyQuickConfig()" style="background: #4CAF50; color: white; width: 100%; padding: 10px; font-size: 14px; font-weight: bold;">
                    ‚úì Appliquer √† tous les mondes
                </button>
            </div>
            
            <!-- Configuration par monde -->
            <div style="background: #FFF9C4; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="color: #F57F17; margin-bottom: 10px; font-size: 16px;">Configuration par monde</h3>
                <div id="auto-worlds-config">
                    <!-- Configuration de chaque monde sera g√©n√©r√©e ici -->
                </div>
            </div>
            
            <!-- Bouton de g√©n√©ration en bas -->
            <button id="generate-btn-bottom" class="btn btn-success" onclick="generateWorldsAutomatically()" style="width: 100%; padding: 15px; font-size: 16px; font-weight: bold;">
                üé≤ G√©n√©rer automatiquement les mondes
            </button>
            </div>
        </div>
        </div>
    </div>

    <!-- Popup de confirmation personnalis√©e -->
    <div id="custom-confirm-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10002;"></div>
    <div id="custom-confirm-modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.5); z-index: 10003; max-width: 500px; text-align: center;">
        <div id="custom-confirm-message" style="font-size: 15px; line-height: 1.6; margin-bottom: 25px; white-space: pre-line;"></div>
        <div style="display: flex; gap: 15px; justify-content: center;">
            <button id="custom-confirm-cancel" class="btn btn-secondary" style="padding: 10px 25px; font-size: 14px; background: #6c757d; color: white;">Annuler</button>
            <button id="custom-confirm-ok" class="btn btn-danger" style="padding: 10px 25px; font-size: 14px; background: #4CAF50; color: white;">Valider</button>
        </div>
    </div>

    <!-- Popup de f√©licitations -->
    <div class="success-popup-overlay" id="success-overlay"></div>
    <div class="success-popup" id="success-popup">
        <div class="emoji">üéâ</div>
        <h2 id="success-title">Bravo !</h2>
        <p id="success-message">Tu as r√©ussi ce niveau !</p>
        <div class="bonus-message" id="bonus-message" style="display: none;"></div>
        <div class="success-popup-buttons">
            <button class="btn-restart" onclick="restartLevel()"><span class="btn-icon">üîÑ</span><span class="btn-text">Recommencer</span></button>
            <button class="btn-next" id="btn-next-level" onclick="nextLevel()"><span class="btn-icon">‚û°Ô∏è</span><span class="btn-text">Niveau suivant</span></button>
        </div>
    </div>

    <!-- Modal pour supprimer un niveau -->
    <div id="delete-modal" class="modal">
        <div class="modal-content">
            <h2>‚ö†Ô∏è Confirmer la suppression</h2>
            <p id="delete-confirm-text">Voulez-vous vraiment supprimer ce niveau ?</p>
            <div class="modal-buttons">
                <button class="btn btn-danger" onclick="confirmDeleteLevel()">Oui, supprimer</button>
                <button class="btn btn-primary" onclick="closeDeleteModal()">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal pour sauvegarder en ligne -->
    <div id="save-online-modal" class="online-modal">
        <div class="online-modal-content">
            <span class="modal-close" onclick="closeSaveOnlineModal()">&times;</span>
            <h2>‚òÅÔ∏è Sauvegarder en ligne</h2>
            <p style="color: #666; font-size: 14px; margin-bottom: 20px;">
                Cr√©ez un lien permanent pour partager vos niveaux avec vos √©l√®ves
            </p>
            
            <input type="text" id="save-prof-name" placeholder="Votre nom (ex: dupont)" maxlength="30">
            
            <div style="background: #E8F5E9; padding: 15px; border-radius: 6px; margin: 15px 0; border: 2px solid #4CAF50;">
                <strong style="color: #2E7D32;">üîë Votre code de s√©curit√© :</strong>
                <div style="display: flex; gap: 10px; align-items: center; margin-top: 10px;">
                    <input type="text" id="save-password" readonly style="font-family: monospace; font-size: 18px; font-weight: bold; text-align: center; letter-spacing: 2px; background: white; flex: 1;">
                    <button onclick="copyPassword()" style="padding: 10px 15px; background: #2196F3; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold;">üìã Copier</button>
                </div>
                <p style="color: #666; font-size: 12px; margin-top: 10px; margin-bottom: 0;">
                    ‚ö†Ô∏è <strong>IMPORTANT :</strong> Notez ce code ! Vous en aurez besoin pour modifier vos niveaux plus tard.
                </p>
            </div>
            
            <div class="captcha-box">
                <span class="captcha-question" id="captcha-question">? + ? =</span>
                <input type="number" id="captcha-answer" class="captcha-input" placeholder="?">
            </div>
            
            <div id="save-message"></div>
            <div id="success-url" class="success-url-box" style="display: none;"></div>
            
            <div class="online-modal-buttons" id="save-modal-buttons">
                <button class="btn-confirm" onclick="confirmSaveOnline()">üíæ Sauvegarder</button>
                <button class="btn-cancel" onclick="closeSaveOnlineModal()">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal pour charger des niveaux existants -->
    <div id="load-online-modal" class="online-modal">
        <div class="online-modal-content">
            <span class="modal-close" onclick="closeLoadOnlineModal()">&times;</span>
            <h2>üì• Charger les niveaux</h2>
            <p style="color: #666; font-size: 14px; margin-bottom: 20px;">
                S√©lectionnez un professeur pour charger ses niveaux
            </p>
            
            <input type="text" id="search-prof-name" placeholder="üîç Rechercher un professeur..." oninput="filterProfessors()" style="margin-bottom: 15px;">
            
            <div style="max-height: 300px; overflow-y: auto; border: 2px solid #E0E0E0; border-radius: 6px; background: #FAFAFA; margin-bottom: 15px;">
                <div id="professors-list" style="padding: 10px;">
                    <div style="text-align: center; color: #999; padding: 20px;">
                        Chargement de la liste des professeurs...
                    </div>
                </div>
            </div>
            
            <div class="info-box">
                ‚ÑπÔ∏è Vous pourrez consulter et modifier les niveaux charg√©s. Pour sauvegarder vos modifications, utilisez "Sauvegarder en ligne" avec votre propre nom.
            </div>
            
            <div id="load-message"></div>
            
            <div class="online-modal-buttons">
                <button class="btn-cancel" onclick="closeLoadOnlineModal()">Fermer</button>
            </div>
        </div>
    </div>

    <!-- Modal pour sauvegarder la progression √©l√®ve -->
    <div id="student-save-modal" class="online-modal">
        <div class="online-modal-content">
            <span class="modal-close" onclick="closeStudentSaveModal()">&times;</span>
            <h2>üíæ Votre code de progression</h2>
            <p style="color: #666; font-size: 14px; margin-bottom: 20px;">
                Notez ce code pour reprendre votre progression plus tard
            </p>
            
            <div style="background: #E3F2FD; padding: 15px; border-radius: 6px; margin: 15px 0; border: 2px solid #2196F3;">
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" id="student-code-display" readonly style="font-family: monospace; font-size: 16px; font-weight: bold; text-align: center; letter-spacing: 1px; background: white; flex: 1; padding: 12px;">
                    <button onclick="copyStudentCode()" style="padding: 10px 15px; background: #2196F3; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; white-space: nowrap;">üìã Copier</button>
                </div>
            </div>
            
            <div class="info-box">
                ‚ÑπÔ∏è Ce code contient votre score, vos niveaux termin√©s et votre progression actuelle.
            </div>
            
            <div class="online-modal-buttons">
                <button class="btn-confirm" onclick="closeStudentSaveModal()" style="width: 100%;">Fermer</button>
            </div>
        </div>
    </div>

    <!-- Modal pour charger la progression √©l√®ve -->
    <div id="student-load-modal" class="online-modal">
        <div class="online-modal-content">
            <span class="modal-close" onclick="closeLoadProgressModal()">&times;</span>
            <h2>üì• Charger ma progression</h2>
            <p style="color: #666; font-size: 14px; margin-bottom: 20px;">
                Entrez votre code de progression pour continuer o√π vous en √©tiez
            </p>
            
            <input type="text" id="student-code-input" placeholder="Collez votre code ici" style="font-family: monospace; text-align: center; letter-spacing: 1px;">
            
            <div id="student-load-message"></div>
            
            <div class="online-modal-buttons">
                <button class="btn-confirm" onclick="loadStudentProgress()">üì• Charger</button>
                <button class="btn-cancel" onclick="closeLoadProgressModal()">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal pour supprimer sa sauvegarde en ligne -->
    <div id="delete-online-modal" class="online-modal">
        <div class="online-modal-content">
            <span class="modal-close" onclick="closeDeleteOnlineModal()">&times;</span>
            <h2>üóëÔ∏è Supprimer ma sauvegarde en ligne</h2>
            <p style="color: #666; font-size: 14px; margin-bottom: 20px;">
                ‚ö†Ô∏è <strong>Attention :</strong> Cette action est irr√©versible !
            </p>
            
            <div style="background: #FFE0E0; padding: 15px; border-radius: 6px; margin-bottom: 20px; border: 2px solid #f44336;">
                <p style="margin: 0; color: #d32f2f; font-weight: bold;">
                    Tous vos niveaux sauvegard√©s en ligne seront d√©finitivement supprim√©s.
                </p>
            </div>
            
            <p style="margin-bottom: 10px; font-weight: bold;">Pour confirmer, entrez votre code de s√©curit√© :</p>
            <input type="password" id="delete-password" placeholder="Code de s√©curit√©">
            
            <div id="delete-message"></div>
            
            <div class="online-modal-buttons">
                <button class="btn-confirm" onclick="confirmDeleteOnline()" style="background: #f44336;">üóëÔ∏è Supprimer d√©finitivement</button>
                <button class="btn-cancel" onclick="closeDeleteOnlineModal()">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal Remerciements -->
    <div id="thanks-modal" class="online-modal">
        <div class="online-modal-content">
            <span class="modal-close" onclick="closeThanksModal()">&times;</span>
            <h2>‚ù§Ô∏è Remerciements</h2>
            
            <div style="background: #FFF3E0; padding: 20px; border-radius: 6px; margin: 15px 0; border: 2px solid #FF9800; text-align: center;">
                <p style="margin: 0; line-height: 1.6; color: #333;">
                    Un grand merci √† tous les beta testeurs qui ont r√©ussi √† trouver des bugs ici ou l√† : 
                    <strong>Samir</strong>, <strong>Jean</strong>, <strong>Hugo</strong>, <strong>Ga√´tan</strong>, <strong>Robin</strong>,
                    au coll√®ge Roquebleue les classes de <strong>5A</strong>, <strong>4A</strong>, <strong>4B</strong> et <strong>3A</strong>, 
                    au coll√®ge Le Bocage la classe de <strong>3A</strong>.
                </p>
            </div>
            
            <div style="background: #E3F2FD; padding: 20px; border-radius: 6px; margin: 15px 0; border: 2px solid #2196F3; text-align: center;">
                <p style="margin: 0; line-height: 1.6; color: #333;">
                    Application cr√©√©e par <strong>Max</strong>, totalement programm√©e par <strong>Claude.ai</strong>.
                </p>
            </div>
            
            <div class="online-modal-buttons">
                <button class="btn-confirm" onclick="closeThanksModal()" style="width: 100%;">Fermer</button>
            </div>
        </div>
    </div>

    <!-- Import de la biblioth√®que de motifs -->
    <script src="js/patterns.js"></script>
    
    <!-- Import du filtre de profanit√© -->
    <script src="js/profanity-filter.js"></script>
    
    <!-- Module: Syst√®me anti-triche -->
    <script src="js/antiCheat.js"></script>
    
    <!-- Module: Gestion du storage (score, progression) -->
    <script src="js/storageManager.js"></script>
    
    <!-- Module: Gestion de la progression -->
    <script src="js/progressionManager.js"></script>
    
    <!-- Module: Gestion des variables -->
    <script src="js/variableManager.js"></script>
    
    <!-- Module: Drag & Drop -->
    <script src="js/dragDropHandler.js"></script>
    
    <!-- Module: Syst√®me de pinceau -->
    <script src="js/paintModule.js"></script>
    
    <!-- Module: Ex√©cution des blocs (tortue) -->
    <script src="js/blockExecution.js"></script>
    
    <!-- Module: Validation des inputs -->
    <script src="js/validationManager.js"></script>
    
    <!-- Module: Touch & Drag (mobile/desktop) - AVANT blockManagement car exporte initSingleBlockDrag -->
    <script src="js/touchDragManager.js"></script>
    
    <!-- Module: Gestion des blocs -->
    <script src="js/blockManagement.js"></script>
    
    <!-- Module: Mode professeur -->
    <script src="js/teacherMode.js"></script>
    
    <!-- Module: Gestion des niveaux et mondes -->
    <script src="js/levelManager.js"></script>
    
    <!-- Module: Cr√©ation automatique de niveaux -->
    <script src="js/autoLevelCreator.js"></script>
    
    <!-- Module: Sauvegarde en ligne -->
    <script src="js/onlineSaveManager.js"></script>
    
    <!-- Module: Popups p√©dagogiques -->
    <script src="js/pedagogicalPopups.js"></script>
    
    <!-- Module: Gestion des versions -->
    <script src="js/versionManager.js"></script>
    
    <!-- Module: Sauvegarde des programmes √©l√®ves -->
    <script src="js/studentProgramStorage.js"></script>

    <!-- Popups p√©dagogiques (utilisant le syst√®me simple-popup) -->
    
    <!-- Popup Preview √âl√®ve -->
    <div id="welcome-preview-modal" class="modal simple-popup">
        <div class="simple-popup-wrapper" style="max-width: 500px;">
            <span class="modal-close" onclick="closeWelcomePreviewModal()">&times;</span>
            <div class="modal-content" style="text-align: center;">
                <h2 style="font-size: 24px;">üëã Bienvenue dans P-Blocks !</h2>
                <p style="font-size: 18px; line-height: 1.8; margin: 20px 0;">Commencez par aller dans le mode <strong>"Cr√©ation de niveaux"</strong> pour en cr√©er.</p>
                <button class="mode-btn" onclick="goToTeacherMode()" style="margin: 20px auto; display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 16px; padding: 12px 24px; background: #5FA3D0; border-color: white;">
                    <span>‚úèÔ∏è Cr√©ation de niveaux</span>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Popup Mode Cr√©ation (bouton ?) -->
    <div id="help-teacher-modal" class="modal simple-popup">
        <div class="simple-popup-wrapper" style="max-width: 680px;">
            <span class="modal-close" onclick="closeHelpTeacherModal()">&times;</span>
            <div class="modal-content" style="text-align: center;">
                <h2 style="font-size: 28px; margin-bottom: 25px;">‚ùì Aide - Mode Cr√©ation</h2>
                
                <strong style="font-size: 22px;">Cr√©ez vos niveaux ici.</strong>
                
                <!-- Partie 1 : Test -->
                <div style="background: #E3F2FD; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <p style="font-size: 20px; line-height: 1.9; margin: 0;">
                        Testez-les dans<br>
                        <img src="images/Apercu_mode_eleve.png" alt="Aper√ßu mode √©l√®ve" style="height: 36px; vertical-align: middle; margin: 10px 0;">
                    </p>
                </div>
                
                <!-- Partie 2 : Sauvegarde -->
                <div style="background: #E8F5E9; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <p style="font-size: 20px; line-height: 1.9; margin: 0;">
                        Sauvegardez-les en ligne<br>
                        <img src="images/Sauvegarde_en_ligne.png" alt="Sauvegarder en ligne" style="height: 36px; vertical-align: middle; margin: 10px 0;"><br>
                        pour avoir une URL d√©di√©e √† donner √† vos √©l√®ves.
                    </p>
                </div>
                
                <!-- Partie 3 : Astuce -->
                <div style="background: #FFF3E0; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <p style="font-size: 20px; line-height: 1.9; margin: 10px 0;">
                        <strong style="font-size: 22px;">üí° Astuce :</strong><br>
                        Cr√©ez automatiquement tous les niveaux :
                    </p>
                    <div style="display: flex; gap: 10px; justify-content: center; margin-top: 15px; flex-wrap: wrap; align-items: center;">
                        <img src="images/BoutonGerer.png" alt="G√©rer" style="height: 40px;">
                        <span style="font-size: 24px; color: #666;">‚Üí</span>
                        <img src="images/BoutonCreationAutomatisee.png" alt="Cr√©ation automatis√©e" style="height: 40px;">
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Popup URL √âl√®ve -->
    <div id="welcome-student-modal" class="modal simple-popup">
        <div class="simple-popup-wrapper" style="max-width: 600px;">
            <span class="modal-close" onclick="closeWelcomeStudentModal()">&times;</span>
            <div class="modal-content" style="text-align: center;">
                <h2 style="font-size: 24px;">üëã Bienvenue dans P-Blocks !</h2>
                <p style="font-size: 18px; line-height: 1.8; margin: 25px 0;">
                    Utilisez les blocs pour reproduire le motif demand√©.<br>
                    Bonne chance ! üöÄ
                </p>
                
                <!-- Cadre color√© pour les points -->
                <div style="background: #FFF9C4; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <p style="font-size: 18px; line-height: 1.8; margin: 0;">
                        üéØ <strong>1 point</strong> pour un motif reproduit.<br>
                        üèÜ <strong>2 points</strong> pour le r√©ussir dans la limite de blocs demand√©e.
                    </p>
                </div>
                
                <!-- Cadre pour choisir le cursus -->
                <div style="background: #E3F2FD; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <p style="font-size: 18px; font-weight: bold; margin-bottom: 15px; color: #1976D2;">
                        üìö Commencez par choisir votre cursus :
                    </p>
                    <div style="display: flex; gap: 15px; justify-content: center;">
                        <button onclick="selectCursusAndStart('5eme')" style="padding: 12px 24px; font-size: 16px; font-weight: bold; background: #4CAF50; color: white; border: none; border-radius: 8px; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                            5√®me
                        </button>
                        <button onclick="selectCursusAndStart('4eme')" style="padding: 12px 24px; font-size: 16px; font-weight: bold; background: #2196F3; color: white; border: none; border-radius: 8px; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                            4√®me
                        </button>
                        <button onclick="selectCursusAndStart('3eme')" style="padding: 12px 24px; font-size: 16px; font-weight: bold; background: #FF9800; color: white; border: none; border-radius: 8px; cursor: pointer; transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                            3√®me
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Popup F√©licitations fin de cursus -->
    <div id="congratulations-modal" class="modal simple-popup">
        <div class="simple-popup-wrapper" style="max-width: 600px;">
            <span class="modal-close" onclick="closeCongratulationsModal()">&times;</span>
            <div class="modal-content" style="text-align: center;">
                <h2 style="font-size: 36px; margin-bottom: 20px;">üéâ F√âLICITATIONS ! üéâ</h2>
                
                <div style="font-size: 80px; margin: 20px 0; animation: bounce 1s infinite;">
                    üèÜ
                </div>
                
                <p style="font-size: 24px; font-weight: bold; color: #4CAF50; margin: 20px 0;">
                    Tu as termin√© tous les niveaux !
                </p>
                
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 15px; margin: 25px 0; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
                    <p style="font-size: 28px; margin: 0; font-weight: bold;" id="final-score-display">
                        Score final : <span id="final-score">0</span> points
                    </p>
                </div>
                
                <p style="font-size: 20px; line-height: 1.6; margin: 20px 0;">
                    Bravo pour ton excellent travail ! üåü<br>
                    Tu ma√Ætrises maintenant la programmation par blocs !
                </p>
                
                <button onclick="closeCongratulationsModal()" style="margin-top: 20px; padding: 15px 40px; font-size: 18px; background: #4CAF50; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);">
                    üéä Super !
                </button>
            </div>
        </div>
    </div>

    <script src="js/helpSystem.js"></script>
    <script src="js/app-new.js"></script>
</body>
</html>
